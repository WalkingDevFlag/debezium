<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🚀 Debezium Real-Time Chat - CDC Learning Project</title>
    <link rel="stylesheet" href="static/styles.css?v=2">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
</head>
<body>
    <!-- Nickname Modal -->
    <div id="nickname-modal" class="modal-overlay">
        <div class="modal-container">
            <div class="modal-header">
                <i class="fas fa-user-circle"></i>
                <h2>Choose Your Nickname</h2>
            </div>
            <div class="modal-body">
                <p class="modal-description">Enter a nickname to join the chat (2-20 characters, letters, numbers, spaces, _ and - allowed)</p>
                <form id="nickname-form" onsubmit="submitNickname(event)">
                    <div class="form-group">
                        <label for="nickname-input">
                            <i class="fas fa-user"></i> Nickname
                        </label>
                        <input 
                            type="text" 
                            id="nickname-input" 
                            placeholder="Enter your nickname..."
                            maxlength="20"
                            autocomplete="off"
                            required
                        />
                        <div class="nickname-char-count">
                            <span id="nickname-char-count">0</span>/20
                        </div>
                        <div id="nickname-error" class="error-message"></div>
                    </div>
                    <div class="modal-actions">
                        <button type="submit" class="btn-primary">
                            <i class="fas fa-check"></i> Join Chat
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-database"></i>
                    <h1>Debezium Real-Time Chat</h1>
                </div>

                <div class="header-right">
                    <div class="user-info">
                        <div class="connection-status">
                            <span class="status-indicator" id="connection-status"></span>
                            <span id="connection-text">Connecting...</span>
                        </div>
                        <div class="user-id">
                            <i class="fas fa-user"></i>
                            <span id="nickname-display">Guest</span>
                            <button id="edit-nickname-btn" class="edit-nickname-btn" onclick="editNickname()" title="Edit Nickname">
                                <i class="fas fa-edit"></i>
                            </button>
                        </div>
                    </div>

                    <button id="theme-toggle" class="theme-toggle-button" aria-label="Toggle dark mode">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg>
                    </button>
                </div>
            </div>
            
            <!-- Navigation Tabs -->
            <nav class="nav-tabs">
                <div class="nav-tabs-container">
                    <button class="nav-tab active" onclick="switchTab('messages')">
                        <i class="fas fa-comments"></i>
                        <span>Messages</span>
                    </button>
                    <button class="nav-tab" onclick="switchTab('dashboard')">
                        <i class="fas fa-chart-line"></i>
                        <span>Dashboard</span>
                    </button>
                </div>
            </nav>
        </header>

        <!-- Main Chat Area -->
        <main class="chat-main">
            <!-- Messages Tab Content -->
            <div id="messages-tab" class="tab-content active">
                <div class="chat-container">
                    <!-- Messages Area -->
                    <div class="messages-container">
                    <div class="messages-header">
                        <h3><i class="fas fa-comments"></i> Real-Time CDC Messages</h3>
                        <div class="message-count">
                            <span id="message-count">0</span> messages
                        </div>
                    </div>
                    <div class="messages" id="messages">
                        <div class="welcome-message">
                            <i class="fas fa-rocket"></i>
                            <p>Welcome to Debezium Real-Time Chat!</p>
                            <p>This project demonstrates Change Data Capture (CDC) in action.</p>
                            <p>Try inserting, updating, or deleting records in the database to see real-time updates!</p>
                        </div>
                    </div>
                </div>

                <!-- Input Area -->
                <div class="input-container">
                    <form class="message-form" action="" onsubmit="sendMessage(event)">
                        <div class="input-group">
                            <input 
                                type="text" 
                                id="messageText" 
                                autocomplete="off" 
                                placeholder="Type your message..."
                                maxlength="500"
                            />
                            <button type="submit" class="send-button">
                                <i class="fas fa-paper-plane"></i>
                                <span>Send</span>
                            </button>
                        </div>
                        <div class="input-footer">
                            <div class="help-text">
                                <i class="fas fa-lightbulb"></i>
                                💡 To test CDC, execute SQL commands in your database (not here). Chat is for messages only.
                            </div>
                            <div class="character-count">
                                <span id="char-count">0</span>/500
                            </div>
                        </div>
                    </form>
                </div>
                </div>

                <!-- Sidebar -->
                <aside class="sidebar">
                    <div class="sidebar-content">
                        <div class="section">
                            <h4><i class="fas fa-info-circle"></i> About CDC</h4>
                            <p>Change Data Capture (CDC) captures database changes in real-time and streams them to connected clients.</p>
                        </div>
                        
                        <div class="section">
                            <h4><i class="fas fa-cogs"></i> Architecture</h4>
                            <div class="architecture-flow">
                                <div class="flow-item">
                                    <i class="fas fa-database"></i>
                                    <span>PostgreSQL</span>
                                </div>
                                <div class="flow-arrow">→</div>
                                <div class="flow-item">
                                    <i class="fas fa-sync"></i>
                                    <span>Debezium</span>
                                </div>
                                <div class="flow-arrow">→</div>
                                <div class="flow-item">
                                    <i class="fas fa-stream"></i>
                                    <span>Kafka</span>
                                </div>
                                <div class="flow-arrow">→</div>
                                <div class="flow-item">
                                    <i class="fas fa-bolt"></i>
                                    <span>WebSocket</span>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h4><i class="fas fa-code"></i> CDC Playground</h4>
                            <div class="commands">
                                <div class="command-section open">
                                    <button class="command-toggle" type="button" aria-expanded="true">
                                        <span class="toggle-icon">›</span>
                                        <i class="fas fa-plus"></i>
                                        <span class="toggle-label">Create</span>
                                    </button>
                                    <div class="command-list">
                                        <div class="command-row">
                                            <button class="command-btn" onclick="insertSampleData('storm')">
                                                <i class="fas fa-user-plus"></i>
                                                <span>Insert Storm</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'insert', 'storm')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="insertSampleData('dr_strange')">
                                                <i class="fas fa-user-plus"></i>
                                                <span>Insert Doctor Strange</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'insert', 'dr_strange')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="insertSampleData('black_panther')">
                                                <i class="fas fa-user-plus"></i>
                                                <span>Insert Black Panther</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'insert', 'black_panther')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="insertSampleData('captain_marvel')">
                                                <i class="fas fa-user-plus"></i>
                                                <span>Insert Captain Marvel</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'insert', 'captain_marvel')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="insertSampleData('green_lantern')">
                                                <i class="fas fa-user-plus"></i>
                                                <span>Insert Green Lantern</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'insert', 'green_lantern')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row command-row-single">
                                            <button class="command-btn command-btn-alt" onclick="insertSampleData()">
                                                <i class="fas fa-random"></i>
                                                <span>Random Insert</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="command-section">
                                    <button class="command-toggle" type="button" aria-expanded="false">
                                        <span class="toggle-icon">›</span>
                                        <i class="fas fa-pen"></i>
                                        <span class="toggle-label">Update</span>
                                    </button>
                                    <div class="command-list">
                                        <div class="command-row">
                                            <button class="command-btn" onclick="updateSampleData('storm_powers')">
                                                <i class="fas fa-edit"></i>
                                                <span>Boost Storm</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'update', 'storm_powers')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="updateSampleData('spider_identity')">
                                                <i class="fas fa-edit"></i>
                                                <span>Swap Spider Identity</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'update', 'spider_identity')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="updateSampleData('batman_kit')">
                                                <i class="fas fa-edit"></i>
                                                <span>Upgrade Batman</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'update', 'batman_kit')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="updateSampleData('marvel_energy')">
                                                <i class="fas fa-edit"></i>
                                                <span>Amplify Captain Marvel</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'update', 'marvel_energy')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="updateSampleData('lighting_team')">
                                                <i class="fas fa-edit"></i>
                                                <span>Tag Black Panther</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'update', 'lighting_team')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row command-row-single">
                                            <button class="command-btn command-btn-alt" onclick="updateSampleData()">
                                                <i class="fas fa-random"></i>
                                                <span>Random Update</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="command-section">
                                    <button class="command-toggle" type="button" aria-expanded="false">
                                        <span class="toggle-icon">›</span>
                                        <i class="fas fa-trash"></i>
                                        <span class="toggle-label">Delete</span>
                                    </button>
                                    <div class="command-list">
                                        <div class="command-row">
                                            <button class="command-btn" onclick="deleteSampleData('retire_batman')">
                                                <i class="fas fa-trash"></i>
                                                <span>Retire Batman</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'delete', 'retire_batman')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="deleteSampleData('retire_magic')">
                                                <i class="fas fa-trash"></i>
                                                <span>Remove Sorcerers</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'delete', 'retire_magic')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="deleteSampleData('retire_secret')">
                                                <i class="fas fa-trash"></i>
                                                <span>Clear Famous Identities</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'delete', 'retire_secret')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="deleteSampleData('retire_duplicates')">
                                                <i class="fas fa-trash"></i>
                                                <span>Remove Duplicate Fliers</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'delete', 'retire_duplicates')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="deleteSampleData('retire_low_power')">
                                                <i class="fas fa-trash"></i>
                                                <span>Drop Low Power Heroes</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'delete', 'retire_low_power')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row command-row-single">
                                            <button class="command-btn command-btn-alt" onclick="deleteSampleData()">
                                                <i class="fas fa-random"></i>
                                                <span>Random Delete</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>

                                <div class="command-section">
                                    <button class="command-toggle" type="button" aria-expanded="false">
                                        <span class="toggle-icon">›</span>
                                        <i class="fas fa-search"></i>
                                        <span class="toggle-label">Select</span>
                                    </button>
                                    <div class="command-list">
                                        <div class="command-row">
                                            <button class="command-btn" onclick="selectSampleData('list_all')">
                                                <i class="fas fa-search"></i>
                                                <span>List All Heroes</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'select', 'list_all')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="selectSampleData('flight_team')">
                                                <i class="fas fa-search"></i>
                                                <span>Search Flyers</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'select', 'flight_team')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="selectSampleData('power_combo')">
                                                <i class="fas fa-search"></i>
                                                <span>Stacked Powers</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'select', 'power_combo')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="selectSampleData('count_total')">
                                                <i class="fas fa-search"></i>
                                                <span>Count Heroes</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'select', 'count_total')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row">
                                            <button class="command-btn" onclick="selectSampleData('secret_watch')">
                                                <i class="fas fa-search"></i>
                                                <span>Secret Identity Watch</span>
                                            </button>
                                            <button class="copy-btn" onclick="copySQL(event, 'select', 'secret_watch')" title="Copy SQL">
                                                <i class="fas fa-copy"></i>
                                            </button>
                                        </div>
                                        <div class="command-row command-row-single">
                                            <button class="command-btn command-btn-alt" onclick="selectSampleData()">
                                                <i class="fas fa-random"></i>
                                                <span>Random Select</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="section">
                            <h4><i class="fas fa-link"></i> Useful Links</h4>
                            <div class="links">
                                <a href="https://debezium.io/" target="_blank">
                                    <i class="fas fa-external-link-alt"></i> Debezium Docs
                                </a>
                                <a href="https://github.com/AndrGab/debezium" target="_blank">
                                    <i class="fab fa-github"></i> GitHub Repository
                                </a>
                                <a href="https://hacktoberfest.digitalocean.com/" target="_blank">
                                    <i class="fas fa-trophy"></i> Hacktoberfest
                                </a>
                            </div>
                        </div>
                    </div>
                </aside>
            </div>

            <!-- Dashboard Tab Content -->
            <div id="dashboard-tab" class="tab-content">
                <div class="dashboard-container">
                    <!-- Metrics Cards -->
                    <div class="metrics-grid">
                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-users"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Connected Users</div>
                                <div class="metric-value" id="metric-users">0</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-comment"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Msg/Min</div>
                                <div class="metric-value" id="metric-msg-min">0</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-database"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Kafka Topics</div>
                                <div class="metric-value" id="metric-topics">-</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-bolt"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">CDC Events/Sec</div>
                                <div class="metric-value" id="metric-cdc-rate">0</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-exchange-alt"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Bytes/Sec</div>
                                <div class="metric-value" id="metric-bytes-rate">0</div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-icon">
                                <i class="fas fa-clock"></i>
                            </div>
                            <div class="metric-content">
                                <div class="metric-label">Latency</div>
                                <div class="metric-value" id="metric-latency">12ms</div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Section -->
                    <div class="charts-container">
                        <!-- Real-time CDC Activity Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3><i class="fas fa-chart-area"></i> Real-time CDC Activity</h3>
                            </div>
                            <div class="chart-body">
                                <canvas id="cdcActivityChart"></canvas>
                            </div>
                        </div>

                        <!-- Operation Distribution Chart -->
                        <div class="chart-card">
                            <div class="chart-header">
                                <h3><i class="fas fa-chart-bar"></i> Operation Distribution (Last 24h)</h3>
                            </div>
                            <div class="chart-body">
                                <div class="operation-bars">
                                    <div class="operation-bar-item">
                                        <div class="operation-bar-header">
                                            <span class="operation-label create">CREATE</span>
                                            <span class="operation-count" id="op-create-count">0</span>
                                        </div>
                                        <div class="operation-bar-track">
                                            <div class="operation-bar-fill create" id="op-create-bar" style="width: 0%"></div>
                                        </div>
                                    </div>

                                    <div class="operation-bar-item">
                                        <div class="operation-bar-header">
                                            <span class="operation-label update">UPDATE</span>
                                            <span class="operation-count" id="op-update-count">0</span>
                                        </div>
                                        <div class="operation-bar-track">
                                            <div class="operation-bar-fill update" id="op-update-bar" style="width: 0%"></div>
                                        </div>
                                    </div>

                                    <div class="operation-bar-item">
                                        <div class="operation-bar-header">
                                            <span class="operation-label delete">DELETE</span>
                                            <span class="operation-count" id="op-delete-count">0</span>
                                        </div>
                                        <div class="operation-bar-track">
                                            <div class="operation-bar-fill delete" id="op-delete-bar" style="width: 0%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Stats -->
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h4><i class="fas fa-info-circle"></i> System Info</h4>
                            <div class="stat-items">
                                <div class="stat-item">
                                    <span class="stat-label">Total Messages:</span>
                                    <span class="stat-value" id="stat-total-messages">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Uptime:</span>
                                    <span class="stat-value" id="stat-uptime">0m</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Active Users:</span>
                                    <span class="stat-value" id="stat-active-users">-</span>
                                </div>
                            </div>
                        </div>

                        <div class="stat-card">
                            <h4><i class="fas fa-database"></i> CDC Events</h4>
                            <div class="stat-items">
                                <div class="stat-item">
                                    <span class="stat-label">Created:</span>
                                    <span class="stat-value stat-create" id="stat-create">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Updated:</span>
                                    <span class="stat-value stat-update" id="stat-update">0</span>
                                </div>
                                <div class="stat-item">
                                    <span class="stat-label">Deleted:</span>
                                    <span class="stat-value stat-delete" id="stat-delete">0</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-left">
                    <span>🎓 Perfect for learning CDC, Event-Driven Architecture, and Real-Time Data Streaming</span>
                </div>
                <div class="footer-right">
                    <span>Made with ❤️ for Hacktoberfest 2025</span>
                </div>
            </div>
        </footer>
    </div>
 
    <script src="static/script.js?v=2"></script>
</body>
</html>
